<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" th:href="@{/css/signup.css}"/>
</head>

<div layout:fragment="content" class="container py-5">
    <div class="input-form-background row">
        <div class="input-form col-md-12 mx-auto">

            <div style="display: flex; align-items: center; justify-content: space-between;">
                <div style="display: flex; align-items: center;">
                    <img th:src="@{/img/profile/2.jpg}" width="70px" style="display: inline">
                    <h4 style="display: inline; margin-left: 5px;">
                        <div th:if="${isOwner}" style="color: slategray; font-size: 17px;">파티장</div>
                        <div th:text="${detail.owner}"></div>
                    </h4>
                    <img th:src="@{/img/yellow.png}" width="33px" style="margin-left: 5px;">
                </div>
                <div style="font-size: 50px;">
                    <span>♡</span>
                </div>
            </div>
            <div style="display: inline-flex; justify-content: space-between; align-items: center; width: 100%;">
                <div><a style="display: inline">지금까지 완료한 파티 수: </a><span>6</span></div>
                <span class="badge rounded-pill" style="text-align: right;"><span th:text="${detail.status.value}"></span></span>
            </div>
            <br><br>

            <div style="text-align: center; padding-top: 15px; padding-bottom: 15px; background-color: white; border-radius: 5px; border-width: 3px; font-size: 18px;  font-weight:bold;"
                 class="mb-3 border border-2">
                <h3><strong th:text="${detail.title}"></strong></h3>
                <hr>
                <div style="font-weight: normal">
                    <div>
                        <span>장소 : </span><span>기흥역</span>
                    </div>
                    <div>
                        <span>인원수 : </span><span>4명</span>
                    </div>
                    <br>
                    <div>
                        <span th:text="${detail.content}"></span>
                    </div>
                    <br>
                    <div style="display: flex; justify-content: space-between; align-items: center; ">
                        <div style="text-align: left; margin-left: 20px; font-size: 15px; color: #6c757d;">
                            <span>작성일 : </span><span th:text="${#temporals.format(detail.dateTime, 'yyyy-MM-dd HH:mm')}"></span>
                        </div>
                        <form style="text-align: right; margin-right: 20px;" th:if="${!isOwner}" th:action="@{/party/join/{id}(id=${detail.partyId})}" method="post">
                            <button class="button" type="submit">파티 신청</button>
                        </form>
                    </div>
                </div>
            </div>
            <div th:if="${isOwner}" th:each="applicant : ${applicants}">
                <div style="text-align: center; padding: 15px; background-color: white; border-radius: 5px; border: 2px solid rgba(193, 176, 239, 0.97); font-size: 17px; font-weight: bold" class="mb-3">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="display: none">
                            <span>멤버Id : </span><span th:text="${applicant.memberId}"></span>
                        </div>
                        <div>
                            <span>닉네임 : </span><span th:text="${applicant.nickname}"></span>
                        </div>
                        <div style="display: flex; justify-content: flex-end;">
                            <form th:action="@{/party/{partyId}/join/accept(partyId=${detail.partyId})}" method="post" style="margin-right: 10px;">
                                <input type="hidden" name="targetId" th:value="${applicant.memberId}">
                                <input type="hidden" name="ownerId" th:value="${detail.ownerId}">
                                <button class="button">수락</button>
                            </form>
                            <form th:action="@{/party/{partyId}/join/deny(partyId=${detail.partyId})}" method="post">
                                <input type="hidden" name="targetId" th:value="${applicant.memberId}">
                                <input type="hidden" name="ownerId" th:value="${detail.ownerId}">
                                <button class="button">거절</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <hr>
            <form th:action="@{/comments}" method="post" class="row2">
                <input type="text" name="comment" class="form-control" id="comment"
                       placeholder="댓글을 입력해주세요." style="width: 550px" value="" required>
                <input type="hidden" name="partyId" th:value="${detail.getPartyId()}">
                <button class="button" type="submit" style="margin-left: 15px;">확인</button>
            </form>
            <br>
            <div th:each="comment : ${comments}" class="mb-3">
                <div style="display: flex; justify-content: space-between">
                    <div style="display: flex">
                        <img th:src="@{/img/profile/1.jpg}" width="40px" style="display: inline">
                        <h5 th:text="${comment.getOwner()}" style="display: inline; margin-left: 5px;"></h5>
                        <img th:src="@{/img/red.png}" width="25px" height="25px">
                    </div>
                    <div style="justify-content: flex-end">
                        <button class="button" style="margin-right: 5px">수정</button>
                        <button class="button">삭제</button>
                    </div>
                </div>
                <h6 th:text="${#temporals.format(comment.getDateTime(), 'yy/MM/dd(E) HH:mm')}" style="text-align: right"></h6>
                <div th:text="${comment.getContent()}"
                     style="flex-grow: 1; text-align: center; padding: 5px; background-color: #fff; border: 2px rgba(193, 176, 239, 0.97); border-radius: 5px; font-size: 18px;"
                     class="mb-3 border border-2">
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript" th:src="@{/js/signup.js}"></script>
</div>
</html>
